---
title: "WebR + Monte Carlo estimate"
format: html
toc: true
webr: 
  show-startup-message: true
  packages: ['tibble', 'dplyr', 'ggplot2']
  autoload-packages: true
filters:
  - webr
---

```{webr-r}
#| context: setup
s <- 1000

theme_set(theme_minimal())

blue <- "#327291"
```

## Number of nets
```{webr-r}
nets <- 1000
```

## Net cost

```{webr-r}
# Parameters
mean <- 4.50
sd <- 0.25

# Simulate
net_costs <- rnorm(n = s, mean = mean, sd = sd)

# Visualize
tibble(x = net_costs) |>
  ggplot(aes(x = x)) +
  geom_histogram(bins = 30, fill = blue, alpha = .8)
```

## Net usage

```{webr-r}
#| message: false
# Parameters
shape1 <- 80
shape2 <- 20

# Simulate
net_usage <- rbeta(s, shape1, shape2)

# Visualize
tibble(
  x = net_usage
) |>
  ggplot(aes(x = x)) +
  geom_histogram(bins = 30) +
  theme_minimal()
```

## People per net

```{webr-r}
# Parameters
meanlog <- 0.5
sdlog <- 0.3

# Simulate
people_per_net <- rlnorm(s, meanlog, sdlog)

# Visualize
tibble(x = people_per_net) |>
  ggplot(aes(x = x)) +
  geom_histogram(bins = 30) +
  theme_minimal()
```

# People protected

```{webr-r}
people_protected <- tibble(
  x = nets * net_usage * people_per_net
)

ggplot(people_protected, aes(x = x)) +
  geom_histogram(bins = 30) +
  theme_minimal()
```

